<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Player Information</title>
    <link href="https://vjs.zencdn.net/7.17.0/video-js.min.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/7.17.0/video.min.js"></script>
    <style>
      /* Your styles here... */
    </style>
  </head>
  <body>
    <h2>Video Catalogue</h2>
    <div class="videoEntry">
      <button type="button" class="collapsible">Articles</button>
      <div class="content">
        <!-- Video 1 -->
        <p>
          <a href="#" class="videoLink" 
          data-src="../G8-10/Articles_ Introduction and Classification_ Uses of A and An _ Article in English Grammar.mp4">
            Introduction and Classification-Uses of A and An
          </a>
        </p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
    
        <!-- Video 2 -->
        <p>
          <a href="#" class="videoLink" 
          data-src="../G8-10/Articles_ Further Use of A and An _ Article in English Grammar.mp4">
            Further Use of A and An
          </a>
        </p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
    
        <!-- Video 3 -->
        <p>
          <a href="#" class="videoLink" 
          data-src="../G8-10/Articles_ Omission of A and An _ Article in English Grammar.mp4">
            Omission of A and An
          </a>
        </p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
    
        <!-- Video 4 -->
        <p>
          <a href="#" class="videoLink" 
          data-src="../G8-10/Articles_ Uses of The _ 2 _ Article in English Grammar.mp4">
            Uses of The - 2
          </a>
        </p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
    
        <!-- Video 5 -->
        <p>
          <a href="#" class="videoLink" 
          data-src="../G8-10/Articles_ Omission of The _ 1 _ Article in English Grammar.mp4">
            Omission of The - 1
          </a>
        </p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
    
        <!-- Video 6 -->
        <p>
          <a href="#" class="videoLink" 
          data-src="../G8-10/Articles_ Omission of The _ 2 _ Article in English Grammar.mp4">
            Omission of The - 2
          </a>
        </p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
      </div>
    </div>
    
    

    <div class="videoEntry">
      <button type="button" class="collapsible">Article 2</button>
      <div class="content">
        <p><a href="#" class="videoLink" data-src="C:/Users/Meta DEV 02/Desktop/video/Articles_ Omission of A and An _ Article in English Grammar1.mp4">Video 1</a></p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
        <p><a href="#" class="videoLink" data-src="C:/Users/Meta DEV 02/Desktop/video/Articles_ Omission of A and An _ Article in English Grammar2.mp4">Video 2</a></p>
        <div class="videoContainer" style="display: none">
          <video class="video-js vjs-default-skin myVideo" controls preload="auto" width="640" height="264" data-setup="{}"></video>
        </div>
      </div>
    </div>




    <!-- Additional video entries... -->

    <script>
      var coll = document.getElementsByClassName("collapsible");
      var videoLinks = document.getElementsByClassName("videoLink");
      var videoData = [];

      for (let i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function () {
          this.classList.toggle("active");
          var content = this.nextElementSibling;
          content.style.display = content.style.display === "block" ? "none" : "block";
        });
      }

      for (let i = 0; i < videoLinks.length; i++) {
        let videoLink = videoLinks[i];
        let videoSrc = videoLink.getAttribute("data-src");
        let videoContainer = videoLink.parentElement.nextElementSibling;
        let videoElem = videoContainer.children[0];
        let player = videojs(videoElem);

        let startTime = 0;
        let startDate = "";

        videoLink.addEventListener("click", function () {
          player.src({ type: "video/mp4", src: videoSrc });
          player.load();

          if (videoContainer.style.display === "none") {
            videoContainer.style.display = "block";
            player.play();
            player.requestFullscreen();
          } else {
            videoContainer.style.display = "none";
            player.pause();
          }
        });

        player.on("play", function () {
          startTime = player.currentTime();
          startDate = new Date();
        });

        player.on("pause", function () {
          var endDate = new Date();
          var endTime = player.currentTime();
          var duration = endTime - startTime;
          var videoInfo = {
            video_name: videoSrc.split("/").pop().split(".")[0],
            location: videoSrc,
            pl_start: startTime,
            start_date_time: startDate.toLocaleString(),
            pl_end: endTime,
            end_date_time: endDate.toLocaleString(),
            duration: duration,
          };
          videoData.push(videoInfo);
          saveJsonToFile(videoData, "video_information.csv");
        });

        player.on("ended", function () {
          var endDate = new Date();
          var endTime = player.currentTime();
          var duration = endTime - startTime;
          var videoInfo = {
            video_name: videoSrc.split("/").pop().split(".")[0],
            location: videoSrc,
            pl_start: startTime,
            start_date_time: startDate.toLocaleString(),
            pl_end: endTime,
            end_date_time: endDate.toLocaleString(),
            duration: duration,
          };
          videoData.push(videoInfo);
          saveJsonToFile(videoData, "video_information.csv");
        });
      }

      function saveJsonToFile(data, filename) {
        var csvContent = convertToCSV(data);
        var file = new Blob([csvContent], { type: "text/csv" });
        var url = URL.createObjectURL(file);

        var a = document.createElement("a");
        a.href = url;
        a.download = filename;
        a.style.display = "none";
        document.body.appendChild(a);
        a.click();

        setTimeout(function () {
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }, 0);
      }

      function convertToCSV(objArray) {
        var array = typeof objArray != "object" ? JSON.parse(objArray) : objArray;
        var str = "";
        var headers = Object.keys(array[0]).map((header) => `"${header}"`).join(",") + "\r\n";

        for (var i = 0; i < array.length; i++) {
          var line = "";
          for (var index in array[i]) {
            if (line != "") line += ",";
            line += `"${array[i][index]}"`;
          }
          str += line + "\r\n";
        }
        return headers + str;
      }
    </script>
  </body>
</html>
